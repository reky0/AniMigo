@if (platformService.isHybrid()) {
  <ion-header [translucent]="true">
    <ion-toolbar>
      <ion-title>Explore</ion-title>
    </ion-toolbar>
  </ion-header>
}

<ion-content>
  <!-- Full Screen Search Overlay -->
  <div class="search-overlay" [class.active]="isSearchActive" [class.has-header]="platformService.isHybrid()">
    <div class="search-header">
      <ion-searchbar
        #searchBar
        placeholder="Search for an anime, manga, character..."
        animated
        color="light"
        [value]="searchQuery"
        (ionInput)="onSearchInput($event)"
        (ionFocus)="activateSearch()"
        (ionCancel)="deactivateSearch()"
        (keydown.enter)="onEnterPress()"
        (keydown.escape)="deactivateSearch()"
        [showCancelButton]="'always'"
      ></ion-searchbar>
    </div>

    <ion-content #resultsContent class="search-content">
      <ion-grid class="search-container">
        <ion-row class="filter-chips-container">
        <ion-row>
          <ion-col>
            <ion-chip
              [outline]="category !== 'anime'"
              color="primary"
              class="filter-chip ion-color-secondary ion-no-margin"
              [class.active]="category === 'anime'"
              (click)="changeCategory('anime')"
              >
              <ion-icon class="ion-no-margin ion-margin-end" name="checkmark" />
              Anime
            </ion-chip>
          </ion-col>
          <ion-col>
            <ion-chip
              [outline]="category !== 'manga'"
              color="primary"
              class="filter-chip ion-color-secondary ion-no-margin"
              [class.active]="category === 'manga'"
              (click)="changeCategory('manga')"
              >
              <ion-icon class="ion-no-margin ion-margin-end" name="checkmark" />
              Manga
            </ion-chip>
          </ion-col>
          <ion-col>
            <ion-chip
              [outline]="category !== 'characters'"
              color="primary"
              class="filter-chip ion-color-secondary ion-no-margin"
              [class.active]="category === 'characters'"
              (click)="changeCategory('characters')"
              >
              <ion-icon class="ion-no-margin ion-margin-end" name="checkmark" />
              Characters
            </ion-chip>
          </ion-col>
          <ion-col>
            <ion-chip
              [outline]="category !== 'staff'"
              color="primary"
              class="filter-chip ion-color-secondary ion-no-margin"
              [class.active]="category === 'staff'"
              (click)="changeCategory('staff')"
              >
              <ion-icon class="ion-no-margin ion-margin-end" name="checkmark" />
              Staff
            </ion-chip>
          </ion-col>
        </ion-row>

        <ion-row class="filter-panel-container">
          <ion-col size="12">
            <div class="filter-panel-header" (click)="toggleFilterPanel()">
              <div class="filter-panel-title">
                <ion-icon [name]="isFilterPanelOpen ? 'chevron-up' : 'chevron-down'"></ion-icon>
                <span>Filters</span>
                @if (activeFiltersCount > 0) {
                  <ion-badge color="primary">{{ activeFiltersCount }}</ion-badge>
                }
              </div>
              @if (activeFiltersCount > 0) {
                <ion-button
                  fill="clear"
                  color="danger"
                  (click)="clearAllFilters(); $event.stopPropagation()">
                  <ion-icon slot="icon-only" name="close-circle"></ion-icon>
                </ion-button>
              }
            </div>

            <div class="filter-panel-content" [class.expanded]="isFilterPanelOpen">
              <!-- ANIME FILTERS -->
              @if (category === 'anime') {
                <ion-grid class="filter-grid">
                  <!-- Format Filter -->
                  <ion-row>
                    <ion-col size="12">
                      <div class="expandable-filter-header" (click)="toggleFormatsExpanded()">
                        <div class="expandable-filter-title">
                          <ion-label class="filter-label">Format</ion-label>
                          @if (filters.formats.length > 0) {
                            <ion-badge color="primary">{{ filters.formats.length }}</ion-badge>
                          }
                        </div>
                        <ion-icon [name]="isFormatsExpanded ? 'chevron-up' : 'chevron-down'"></ion-icon>
                      </div>

                      @if (isFormatsExpanded) {
                        <div class="expandable-filter-content">
                          <div class="checkbox-list">
                            @for (format of animeFormats; track format.value) {
                              <div class="checkbox-item" (click)="toggleFilter('formats', format.value)">
                                <ion-checkbox
                                  [checked]="filters.formats.includes(format.value)">
                                </ion-checkbox>
                                <span class="checkbox-label">{{ format.label }}</span>
                              </div>
                            }
                          </div>
                        </div>
                      }
                    </ion-col>
                  </ion-row>

                  <!-- Status Filter -->
                  <ion-row>
                    <ion-col size="12">
                      <div class="expandable-filter-header" (click)="toggleStatusesExpanded()">
                        <div class="expandable-filter-title">
                          <ion-label class="filter-label">Status</ion-label>
                          @if (filters.statuses.length > 0) {
                            <ion-badge color="primary">{{ filters.statuses.length }}</ion-badge>
                          }
                        </div>
                        <ion-icon [name]="isStatusesExpanded ? 'chevron-up' : 'chevron-down'"></ion-icon>
                      </div>

                      @if (isStatusesExpanded) {
                        <div class="expandable-filter-content">
                          <div class="checkbox-list">
                            @for (status of animeStatuses; track status.value) {
                              <div class="checkbox-item" (click)="toggleFilter('statuses', status.value)">
                                <ion-checkbox
                                  [checked]="filters.statuses.includes(status.value)">
                                </ion-checkbox>
                                <span class="checkbox-label">{{ status.label }}</span>
                              </div>
                            }
                          </div>
                        </div>
                      }
                    </ion-col>
                  </ion-row>

                  <!-- Year Filter -->
                  <ion-row>
                    <ion-col size="12">
                      <ion-label class="filter-label">Year</ion-label>
                      <div class="year-filter-wrapper">
                        <ion-range
                          [min]="1940"
                          [max]="currentYear + 1"
                          [value]="{lower: filters.yearRange.start, upper: filters.yearRange.end}"
                          [dualKnobs]="true"
                          [pin]="true"
                          [snaps]="true"
                          (ionChange)="onYearRangeChange($event)">
                        </ion-range>
                        <div class="year-labels">
                          <span>{{ filters.yearRange.start }}</span>
                          <span>{{ filters.yearRange.end }}</span>
                        </div>
                      </div>
                    </ion-col>
                  </ion-row>

                  <!-- Genres Filter -->
                  <ion-row>
                    <ion-col size="12">
                      <div class="expandable-filter-header" (click)="toggleGenresExpanded()">
                        <div class="expandable-filter-title">
                          <ion-label class="filter-label">Genres</ion-label>
                          @if (filters.genres.length > 0) {
                            <ion-badge>{{filters.genres.length}}</ion-badge>
                          }
                        </div>
                        <ion-icon [name]="isGenresExpanded ? 'chevron-up' : 'chevron-down'"></ion-icon>
                      </div>

                      @if (isGenresExpanded) {
                        <div class="expandable-filter-content">
                          <div class="checkbox-list">
                            @for (genre of genres; track genre.value) {
                              @if (genre.value !== 'Hentai' || (genre.value === 'Hentai' && authService.getUserData()?.options?.displayAdultContent)) {
                                <div class="checkbox-item" (click)="toggleFilter('genres', genre.value)">
                                  <ion-checkbox
                                  [checked]="filters.genres.includes(genre.value)">
                                  </ion-checkbox>
                                  <span class="checkbox-label">
                                    {{ genre.label }}
                                    @if (genre.value === 'Hentai') {
                                      <ion-badge color="danger">Adult</ion-badge>
                                    }
                                  </span>
                                </div>
                              }
                            }
                          </div>
                        </div>
                      }
                    </ion-col>
                  </ion-row>

                  <!-- Tags Filter -->
                  <ion-row>
                    <ion-col size="12">
                      <div class="expandable-filter-header" (click)="toggleTagsExpanded()">
                        <div class="expandable-filter-title">
                          <ion-label class="filter-label">Tags</ion-label>
                          @if (filters.tags.length > 0) {
                            <ion-badge color="secondary">{{ filters.tags.length }}</ion-badge>
                          }
                        </div>
                        <ion-icon [name]="isTagsExpanded ? 'chevron-up' : 'chevron-down'"></ion-icon>
                      </div>

                      @if (isTagsExpanded) {
                        <div class="expandable-filter-content">
                          <div class="checkbox-list">
                            @for (tag of tags; track tag.name) {
                              @if (!tag.isAdult || (tag.isAdult && authService.getUserData()?.options?.displayAdultContent)) {
                                <div
                                  class="checkbox-item"
                                  [title]="tag.description"
                                  (click)="toggleFilter('tags', tag.name)"
                                  >
                                  <ion-checkbox
                                    [checked]="filters.tags.includes(tag.name)">
                                  </ion-checkbox>
                                  <span class="checkbox-label">
                                    {{ tag.name }}
                                    @if (tag.isAdult) {
                                      <ion-badge color="danger">Adult</ion-badge>
                                    }
                                  </span>
                                </div>
                              }
                            }
                          </div>
                        </div>
                      }
                    </ion-col>
                  </ion-row>

                  <!-- Sort By -->
                  <ion-row>
                    <ion-col size="12">
                      <div class="expandable-filter-header" (click)="toggleSortByExpanded()">
                        <div class="expandable-filter-title">
                          <ion-label class="filter-label">Sort By</ion-label>
                        </div>
                        <ion-icon [name]="isSortByExpanded ? 'chevron-up' : 'chevron-down'"></ion-icon>
                      </div>

                      @if (isSortByExpanded) {
                        <div class="expandable-filter-content">
                          <ion-radio-group [value]="filters.sortBy" (ionChange)="setFilter('sortBy', $event.detail.value)">
                            <div class="radio-list">
                              @for (sort of animeSortOptions; track sort.value) {
                                <div class="radio-item">
                                  <ion-radio [value]="sort.value" labelPlacement="start">
                                    <div class="radio-label-with-icon">
                                      <ion-icon [name]="sort.icon"></ion-icon>
                                      <span>{{ sort.label }}</span>
                                    </div>
                                  </ion-radio>
                                </div>
                              }
                            </div>
                          </ion-radio-group>
                        </div>
                      }
                    </ion-col>
                  </ion-row>
                </ion-grid>
              }

              <!-- MANGA FILTERS -->
              @if (category === 'manga') {
                <ion-grid class="filter-grid">
                  <!-- Format Filter -->
                  <ion-row>
                    <ion-col size="12">
                      <div class="expandable-filter-header" (click)="toggleFormatsExpanded()">
                        <div class="expandable-filter-title">
                          <ion-label class="filter-label">Format</ion-label>
                          @if (filters.formats.length > 0) {
                            <ion-badge color="primary">{{ filters.formats.length }}</ion-badge>
                          }
                        </div>
                        <ion-icon [name]="isFormatsExpanded ? 'chevron-up' : 'chevron-down'"></ion-icon>
                      </div>

                      @if (isFormatsExpanded) {
                        <div class="expandable-filter-content">
                          <div class="checkbox-list">
                            @for (format of mangaFormats; track format.value) {
                              <div class="checkbox-item" (click)="toggleFilter('formats', format.value)">
                                <ion-checkbox
                                  [checked]="filters.formats.includes(format.value)">
                                </ion-checkbox>
                                <span class="checkbox-label">{{ format.label }}</span>
                              </div>
                            }
                          </div>
                        </div>
                      }
                    </ion-col>
                  </ion-row>

                  <!-- Status Filter -->
                  <ion-row>
                    <ion-col size="12">
                      <div class="expandable-filter-header" (click)="toggleStatusesExpanded()">
                        <div class="expandable-filter-title">
                          <ion-label class="filter-label">Status</ion-label>
                          @if (filters.statuses.length > 0) {
                            <ion-badge color="primary">{{ filters.statuses.length }}</ion-badge>
                          }
                        </div>
                        <ion-icon [name]="isStatusesExpanded ? 'chevron-up' : 'chevron-down'"></ion-icon>
                      </div>

                      @if (isStatusesExpanded) {
                        <div class="expandable-filter-content">
                          <div class="checkbox-list">
                            @for (status of mangaStatuses; track status.value) {
                              <div class="checkbox-item" (click)="toggleFilter('statuses', status.value)">
                                <ion-checkbox
                                  [checked]="filters.statuses.includes(status.value)">
                                </ion-checkbox>
                                <span class="checkbox-label">{{ status.label }}</span>
                              </div>
                            }
                          </div>
                        </div>
                      }
                    </ion-col>
                  </ion-row>

                  <!-- Year Filter -->
                  <ion-row>
                    <ion-col size="12">
                      <ion-label class="filter-label">Year</ion-label>
                      <div class="year-filter-wrapper">
                        <ion-range
                          [min]="1940"
                          [max]="currentYear + 1"
                          [value]="{lower: filters.yearRange.start, upper: filters.yearRange.end}"
                          [dualKnobs]="true"
                          [pin]="true"
                          [snaps]="true"
                          (ionChange)="onYearRangeChange($event)">
                        </ion-range>
                        <div class="year-labels">
                          <span>{{ filters.yearRange.start }}</span>
                          <span>{{ filters.yearRange.end }}</span>
                        </div>
                      </div>
                    </ion-col>
                  </ion-row>

                  <!-- Genres Filter -->
                  <ion-row>
                    <ion-col size="12">
                      <div class="expandable-filter-header" (click)="toggleGenresExpanded()">
                        <div class="expandable-filter-title">
                          <ion-label class="filter-label">Genres</ion-label>
                          @if (filters.genres.length > 0) {
                            <ion-badge color="secondary">{{ filters.genres.length }}</ion-badge>
                          }
                        </div>
                        <ion-icon [name]="isGenresExpanded ? 'chevron-up' : 'chevron-down'"></ion-icon>
                      </div>
                      @if (isGenresExpanded) {
                        <div class="expandable-filter-content">
                          <div class="checkbox-list">
                            @for (genre of genres; track genre.value) {
                              @if (genre.value !== 'Hentai' || (genre.value === 'Hentai' && authService.getUserData()?.options?.displayAdultContent)) {
                                <div class="checkbox-item" (click)="toggleFilter('genres', genre.value)">
                                  <ion-checkbox
                                    [checked]="filters.genres.includes(genre.value)">
                                  </ion-checkbox>
                                  <span class="checkbox-label">
                                    {{ genre.label }}
                                    @if (genre.value === 'Hentai') {
                                      <ion-badge color="danger">Adult</ion-badge>
                                    }
                                  </span>
                                </div>
                              }
                            }
                          </div>
                        </div>
                      }
                    </ion-col>
                  </ion-row>

                  <!-- Tags Filter -->
                  <ion-row>
                    <ion-col size="12">
                      <div class="expandable-filter-header" (click)="toggleTagsExpanded()">
                        <div class="expandable-filter-title">
                          <ion-label class="filter-label">Tags</ion-label>
                          @if (filters.tags.length > 0) {
                            <ion-badge color="secondary">{{ filters.tags.length }}</ion-badge>
                          }
                        </div>
                        <ion-icon [name]="isTagsExpanded ? 'chevron-up' : 'chevron-down'"></ion-icon>
                      </div>

                      @if (isTagsExpanded) {
                        <div class="expandable-filter-content">
                          <div class="checkbox-list">
                            @for (tag of tags; track tag.name) {
                              @if (!tag.isAdult || (tag.isAdult && authService.getUserData()?.options?.displayAdultContent)) {
                                <div class="checkbox-item" (click)="toggleFilter('tags', tag.name)">
                                  <ion-checkbox
                                    [checked]="filters.tags.includes(tag.name)">
                                  </ion-checkbox>
                                  <span class="checkbox-label">
                                    {{ tag.name }}
                                    @if (tag.isAdult) {
                                      <ion-badge color="danger">Adult</ion-badge>
                                    }
                                  </span>
                                </div>
                              }
                            }
                          </div>
                        </div>
                      }
                    </ion-col>
                  </ion-row>

                  <!-- Sort By -->
                  <ion-row>
                    <ion-col size="12">
                      <div class="expandable-filter-header" (click)="toggleSortByExpanded()">
                        <div class="expandable-filter-title">
                          <ion-label class="filter-label">Sort By</ion-label>
                        </div>
                        <ion-icon [name]="isSortByExpanded ? 'chevron-up' : 'chevron-down'"></ion-icon>
                      </div>

                      @if (isSortByExpanded) {
                        <div class="expandable-filter-content">
                          <ion-radio-group [value]="filters.sortBy" (ionChange)="setFilter('sortBy', $event.detail.value)">
                            <div class="radio-list">
                              @for (sort of mangaSortOptions; track sort.value) {
                                <div class="radio-item">
                                  <ion-radio [value]="sort.value" labelPlacement="start">
                                    <div class="radio-label-with-icon">
                                      <ion-icon [name]="sort.icon"></ion-icon>
                                      <span>{{ sort.label }}</span>
                                    </div>
                                  </ion-radio>
                                </div>
                              }
                            </div>
                          </ion-radio-group>
                        </div>
                      }
                    </ion-col>
                  </ion-row>
                </ion-grid>
              }

              <!-- CHARACTER FILTERS -->
              @if (category === 'characters') {
                <ion-grid class="filter-grid">
                  <!-- Birthday Today Filter -->
                  <ion-row>
                    <ion-col size="12">
                      <ion-chip
                        [outline]="!filters.isBirthday"
                        color="success"
                        class="birthday-chip"
                        (click)="toggleBirthdayFilter()">
                        <ion-icon name="gift" class="ion-margin-end"></ion-icon>
                        @if (filters.isBirthday) {
                          <ion-icon name="checkmark" class="ion-margin-end"></ion-icon>
                        }
                        Birthday Today
                      </ion-chip>
                    </ion-col>
                  </ion-row>

                  <!-- Sort By -->
                  <ion-row>
                    <ion-col size="12">
                      <div class="expandable-filter-header" (click)="toggleSortByExpanded()">
                        <div class="expandable-filter-title">
                          <ion-label class="filter-label">Sort By</ion-label>
                        </div>
                        <ion-icon [name]="isSortByExpanded ? 'chevron-up' : 'chevron-down'"></ion-icon>
                      </div>

                      @if (isSortByExpanded) {
                        <div class="expandable-filter-content">
                          <ion-radio-group [value]="filters.sortBy" (ionChange)="setFilter('sortBy', $event.detail.value)">
                            <div class="radio-list">
                              @for (sort of peopleSortOptions; track sort.value) {
                                <div class="radio-item">
                                  <ion-radio [value]="sort.value" labelPlacement="start">
                                    <div class="radio-label-with-icon">
                                      <ion-icon [name]="sort.icon"></ion-icon>
                                      <span>{{ sort.label }}</span>
                                    </div>
                                  </ion-radio>
                                </div>
                              }
                            </div>
                          </ion-radio-group>
                        </div>
                      }
                    </ion-col>
                  </ion-row>
                </ion-grid>
              }

              <!-- STAFF FILTERS -->
              @if (category === 'staff') {
                <ion-grid class="filter-grid">
                  <!-- Birthday Today Filter -->
                  <ion-row>
                    <ion-col size="12">
                      <ion-chip
                        [outline]="!filters.isBirthday"
                        color="success"
                        class="birthday-chip"
                        (click)="toggleBirthdayFilter()">
                        <ion-icon name="gift" class="ion-margin-end"></ion-icon>
                        @if (filters.isBirthday) {
                          <ion-icon name="checkmark" class="ion-margin-end"></ion-icon>
                        }
                        Birthday Today
                      </ion-chip>
                    </ion-col>
                  </ion-row>

                  <!-- Sort By -->
                  <ion-row>
                    <ion-col size="12">
                      <div class="expandable-filter-header" (click)="toggleSortByExpanded()">
                        <div class="expandable-filter-title">
                          <ion-label class="filter-label">Sort By</ion-label>
                        </div>
                        <ion-icon [name]="isSortByExpanded ? 'chevron-up' : 'chevron-down'"></ion-icon>
                      </div>

                      @if (isSortByExpanded) {
                        <div class="expandable-filter-content">
                          <ion-radio-group [value]="filters.sortBy" (ionChange)="setFilter('sortBy', $event.detail.value)">
                            <div class="radio-list">
                              @for (sort of peopleSortOptions; track sort.value) {
                                <div class="radio-item">
                                  <ion-radio [value]="sort.value" labelPlacement="start">
                                    <div class="radio-label-with-icon">
                                      <ion-icon [name]="sort.icon"></ion-icon>
                                      <span>{{ sort.label }}</span>
                                    </div>
                                  </ion-radio>
                                </div>
                              }
                            </div>
                          </ion-radio-group>
                        </div>
                      }
                    </ion-col>
                  </ion-row>
                </ion-grid>
              }
            </div>

            <!-- Apply Filters Button -->
            @if (isFilterPanelOpen && hasUnappliedFilters) {
              <div class="apply-filters-section">
                <ion-button
                  expand="block"
                  color="primary"
                  (click)="applyFilters()">
                  <ion-icon slot="start" name="checkmark-circle"></ion-icon>
                  Apply Filters
                </ion-button>
              </div>
            }
          </ion-col>
        </ion-row>
      </ion-row>

      <ion-row class="search-results">
        @if (searchQuery.length === 0 && results.length === 0 && !hasActiveFilters()) {
          <ion-col class="empty-state">
            <ion-icon name="search-outline"></ion-icon>
            <p>Start typing to search or apply filters</p>
            <p class="hint">Type at least 3 characters or select filters</p>
          </ion-col>
        } @else if (searchQuery.length < 3 && results.length === 0 && !hasActiveFilters()) {
          <ion-col class="empty-state">
            <ion-icon name="text-outline"></ion-icon>
            <p>Type at least {{ 3 - searchQuery.length }} more character{{ (3 - searchQuery.length) > 1 ? 's' : '' }} or apply filters</p>
          </ion-col>
        } @else if (isSearching) {
          <ion-col class="empty-state">
            <ion-spinner name="crescent"></ion-spinner>
            <p>Searching...</p>
          </ion-col>
        } @else if (results.length === 0) {
          <ion-col class="empty-state">
            <ion-icon name="ban-outline"></ion-icon>
            <p>No results found</p>
            <p class="hint">Try a different search term</p>
          </ion-col>
        } @else {
          <!-- Search results will appear here -->
          <ion-col size="12" class="results-wrapper">
            @if (storedQuery.length > 0) {
              <ion-card-subtitle class="results-info">Searching for "{{ storedQuery }}"</ion-card-subtitle>
            }
            <ion-grid>
              <ion-row class="ion-padding-bottom">
                <!-- Add your search results items here -->
                @for (result of results; track result.id) {
                      @if (category === 'anime' || category === 'manga') {
                        <ion-col size="12" sizeMd="6" sizeLg="4">
                          <am-media-list-item
                            [media]="result"
                            [isFavourite]="result.isFavourite"
                            [isAdult]="result.isAdult"
                            (click)="goToDetails({id: result.id, type: result.type, isAdult: result.isAdult})"
                            />
                        </ion-col>
                      } @else if (category === 'characters') {
                        <ion-col size="4" sizeMd="2" sizeLg="1">
                          <am-person-item
                            [name]="result.name.full ?? result.name.native"
                            [image]="result.image.large?.replace('medium', 'large') ?? result.image.medium"
                            [fallbackImage]="result.image.large"
                            [isFavourite]="result.isFavourite"
                            (click)="openModal('character', result)"
                            />
                        </ion-col>
                      } @else if (category === 'staff') {
                        <ion-col size="4" sizeMd="2" sizeLg="1">
                          <am-person-item
                            [name]="result.name.full ?? result.name.native"
                            [image]="result.image.large?.replace('medium', 'large') ?? result.image.medium"
                            [fallbackImage]="result.image.large"
                            [isFavourite]="result.isFavourite"
                            (click)="openModal('staff', result)"
                            />
                        </ion-col>
                      }
                    }
                  </ion-row>
                </ion-grid>
            <ion-infinite-scroll
              threshold="0px"
              (ionInfinite)="onIonInfinite($event)"
              >
              <ion-infinite-scroll-content loadingSpinner="bubbles"/>
            </ion-infinite-scroll>
          </ion-col>
        }
      </ion-row>
      </ion-grid>
    </ion-content>
  </div>

  <!-- QUICK ACCESS OPTIONS -->
  <ion-grid>
    <ion-row>
      <ion-col class="ion-no-padding">
        <div class="searchbar-trigger" (click)="activateSearch()">
          <ion-searchbar
            placeholder="Search for an anime, manga, character..."
            animated
            color="light"
            readonly
          ></ion-searchbar>
        </div>
      </ion-col>
    </ion-row>

    <ion-row>
      <ion-col>
        <ion-title>Anime</ion-title>
      </ion-col>
    </ion-row>

    <ion-row>
      <ion-col sizeXs="6" sizeMd="3">
        <am-info-chip
          icon="star"
          info="Top 100"
          type="text"
          (click)="navigate('anime/top-100')"
          clickable
        />
      </ion-col>
      <ion-col sizeXs="6" sizeMd="3">
        <am-info-chip
          icon="stats-chart"
          info="Top Popular"
          type="text"
          (click)="navigate('anime/top-popular')"
          clickable
        />
      </ion-col>
      <ion-col sizeXs="6" sizeMd="3">
        <am-info-chip
          icon="time"
          info="Upcoming"
          type="text"
          (click)="navigate('anime/upcoming')"
          clickable
        />
      </ion-col>
      <ion-col sizeXs="6" sizeMd="3">
        <am-info-chip
          icon="radio"
          info="Airing"
          type="text"
          (click)="navigate('anime/airing')"
          clickable
        />
      </ion-col>
      <ion-col sizeXs="6" sizeMd="3">
        <am-info-chip
          icon="flower"
          info="Spring"
          type="text"
          clickable
        />
      </ion-col>
      <ion-col sizeXs="6" sizeMd="3">
        <am-info-chip
          icon="sunny"
          info="Summer"
          type="text"
          clickable
        />
      </ion-col>
      <ion-col sizeXs="6" sizeMd="3">
        <am-info-chip
          icon="rainy"
          info="Fall"
          type="text"
          clickable
        />
      </ion-col>
      <ion-col sizeXs="6" sizeMd="3">
        <am-info-chip
          icon="snow"
          info="Winter"
          type="text"
          clickable
        />
      </ion-col>
      <ion-col sizeXs="6">
        <am-info-chip
          icon="film"
          info="Top Movies"
          type="text"
          (click)="navigate('anime/top-movies')"
          clickable
        />
      </ion-col>
      <ion-col sizeXs="6">
        <am-info-chip
          icon="calendar"
          info="Calendar"
          type="text"
          (click)="navigate('calendar')"
          clickable
        />
      </ion-col>
    </ion-row>

    <ion-row>
      <ion-col>
        <ion-title>Manga</ion-title>
      </ion-col>
    </ion-row>

    <ion-row>
      <ion-col sizeXs="6" sizeMd="3">
        <am-info-chip
          icon="star"
          info="Top 100"
          type="text"
          (click)="navigate('manga/top-100')"
          clickable
        />
      </ion-col>
      <ion-col sizeXs="6" sizeMd="3">
        <am-info-chip
          icon="stats-chart"
          info="Top Popular"
          type="text"
          (click)="navigate('manga/top-popular')"
          clickable
        />
      </ion-col>
      <ion-col sizeXs="6" sizeMd="3">
        <am-info-chip
          icon="time"
          info="Upcoming"
          type="text"
          (click)="navigate('manga/upcoming')"
          clickable
        />
      </ion-col>
      <ion-col sizeXs="6" sizeMd="3">
        <am-info-chip
          icon="radio"
          info="Publishing"
          type="text"
          (click)="navigate('manga/publishing')"
          clickable
        />
      </ion-col>
    </ion-row>
  </ion-grid>

  <!-- MODAL -->
  <ion-modal [isOpen]="isModalOpen" (willDismiss)="closeModal()">
    <ng-template>
      <ion-header>
        <ion-toolbar>
          <ion-buttons slot="start">
            <ion-button
              class="closeModalButton"
              (click)="closeModal()"
              >
              <ion-icon name="arrow-back" />
            </ion-button>
          </ion-buttons>

          <ion-buttons slot="end">
            @if (authService.isAuthenticated()) {
              <ion-button
                (click)="isCharacter(modalData) ? toggleCharacterFavorite() : toggleStaffFavorite()"
                [disabled]="isTogglingFavorite">
                @if (isTogglingFavorite) {
                  <ion-spinner name="dots" slot="icon-only"></ion-spinner>
                } @else {
                  <ion-icon
                    slot="icon-only"
                    [name]="modalData?.isFavourite ? 'heart' : 'heart-outline'"
                    [color]="modalData?.isFavourite ? 'danger' : 'medium'">
                  </ion-icon>
                }
              </ion-button>
            }

            <ion-button>
              <ion-icon slot="icon-only" name="share-social"></ion-icon>
            </ion-button>
          </ion-buttons>
        </ion-toolbar>
        <ion-toolbar>
          <ion-grid>
            <ion-row>
              <ion-col>
                <ion-segment
                  [value]="modalSelectedTab"
                  (ionChange)="onSegmentChange($event)"
                  mode="md"
                  class="tab-segment">

                  <ion-segment-button value="info" layout="icon-top">
                    <ion-icon name="information-circle"></ion-icon>
                  </ion-segment-button>

                  <ion-segment-button value="media" layout="icon-top">
                    <ion-icon name="film"></ion-icon>
                  </ion-segment-button>

                  @if (!isCharacter(modalData)) {
                    <ion-segment-button value="va" layout="icon-top">
                      <ion-icon name="mic"></ion-icon>
                    </ion-segment-button>
                  }
                </ion-segment>
              </ion-col>
            </ion-row>
          </ion-grid>
        </ion-toolbar>
      </ion-header>
      <ion-content class="ion-no-padding">
        <ion-grid>
          <ion-row class="tabsContainer">
            @if (!modalDataLoading) {
              @switch (modalSelectedTab) {
                @case ('info') {
                  <am-people-info-tab [data]="modalData" [loading]="modalDataLoading" />
                }
                @case ('media') {
                  <am-people-media-tab [data]="modalData" (navigate)="goToDetails($event)" />
                }
                @case ('va') {
                  <am-people-va-tab [data]="modalData" (navigate)="goToDetails($event)" />
                }
              }
            } <!-- @else {
              <ion-col>
                @for (i of 7 | range; track i) {
                  <ion-row>
                    <ion-col size="12">
                      <ion-skeleton-text class="skeleton" animated/>
                    </ion-col>
                  </ion-row>
                }
              </ion-col>
            } -->
          </ion-row>
        </ion-grid>
      </ion-content>
    </ng-template>
  </ion-modal>

</ion-content>
